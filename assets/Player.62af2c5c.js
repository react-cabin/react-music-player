import{g as se,o as oe,w as V,u as c,_ as Q,d as K,r as b,c as d,a as ne,b as Y,e as J,f as s,n as B,h as x,i as D,P,j as R,k as re,t as S,l as Z,m as F,p as N,q as ae,v as ce,s as le,x as ie,y as ue}from"./index.7fb72238.js";function de(t){return se()?(oe(t),!0):!1}var q;const T=typeof window!="undefined",pe=t=>typeof t=="string",I=()=>{};T&&((q=window==null?void 0:window.navigator)==null?void 0:q.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function ge(t){var n;const e=c(t);return(n=e==null?void 0:e.$el)!=null?n:e}const he=T?window:void 0;T&&window.document;T&&window.navigator;T&&window.location;function z(...t){let n,e,a,r;if(pe(t[0])?([e,a,r]=t,n=he):[n,e,a,r]=t,!n)return I;let o=I;const p=V(()=>ge(n),g=>{o(),g&&(g.addEventListener(e,a,r),o=()=>{g.removeEventListener(e,a,r),o=I})},{immediate:!0,flush:"post"}),y=()=>{p(),o()};return de(y),y}const O=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},A="__vueuse_ssr_handlers__";O[A]=O[A]||{};O[A];var G;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(G||(G={}));const ve={class:"bar-inner"},fe=["onMousedown","onMousemove","onMouseup","onTouchstart","onTouchmove","onTouchend"],_e=K({name:"ProgressBar",props:{progress:null,hasBtn:{type:Boolean,default:!0},barColor:{default:""}},emits:["progress-changing","progress-changed"],setup(t,{emit:n}){const e=t,a=16,r=b(0),o=b(null),p=b(null),y=d(()=>({width:`${r.value}px`,backgroundColor:e.barColor})),g=d(()=>({transform:`translate3d(${r.value}px,0,0)`}));V(()=>e.progress,i=>{var v;const l=((v=o.value)==null?void 0:v.clientWidth)-(e.hasBtn?a:0);r.value=l*i}),ne(()=>{var l;const i=((l=o.value)==null?void 0:l.clientWidth)-(e.hasBtn?a:0);r.value=i*e.progress});const _={x1:0,beginWidth:0};let C=!1;const M=i=>{var l;C=!0,_.x1=i instanceof TouchEvent?i.touches[0].pageX:i.pageX,_.beginWidth=(l=p.value)==null?void 0:l.clientWidth},W=i=>{var u;if(!C)return;const l=(i instanceof TouchEvent?i.touches[0].pageX:i.pageX)-_.x1,v=_.beginWidth+l,m=((u=o.value)==null?void 0:u.clientWidth)-(e.hasBtn?a:0),f=Math.min(1,Math.max(v/m,0));r.value=m*f,n("progress-changing",f)},w=i=>{var m,f;if(!C)return;C=!1;const l=((m=o.value)==null?void 0:m.clientWidth)-(e.hasBtn?a:0),v=((f=p.value)==null?void 0:f.clientWidth)/l;n("progress-changed",v)},k=i=>{var u,h;const l=(u=o.value)==null?void 0:u.getBoundingClientRect(),v=i.pageX-l.left,m=((h=o.value)==null?void 0:h.clientWidth)-(e.hasBtn?a:0),f=Math.min(1,Math.max(v/m,0));n("progress-changed",f)};return z(document,"mouseup",w),z(document,"touchend",w),(i,l)=>(Y(),J("div",{ref_key:"barRef",ref:o,class:"progress-bar",onClick:k},[s("div",ve,[s("div",{ref_key:"progressRef",ref:p,class:"progress",style:B(c(y))},null,4),s("div",{class:"progress-btn-wrapper",style:B(c(g)),onMousedown:x(M,["prevent"]),onMousemove:x(W,["prevent"]),onMouseup:x(w,["prevent"]),onTouchstart:x(M,["prevent"]),onTouchmove:x(W,["prevent"]),onTouchend:x(w,["prevent"]),onClick:l[0]||(l[0]=x(()=>{},["stop"]))},[s("div",{class:"progress-btn",style:B({backgroundColor:e.barColor})},null,4)],44,fe)])],512))}});var H=Q(_e,[["__scopeId","data-v-6b780afa"]]);function me(){const t=b(null),n=b(null),e=D(),a=d(()=>e.playing),r=d(()=>a.value?"playing":"");V(a,p=>{p||o(t.value,n.value)});function o(p,y){const g=getComputedStyle(p).transform,_=getComputedStyle(y).transform;p.style.transform=g==="none"?_:_.concat(g)}return{cdRef:t,cdCoverRef:n,cdClass:r}}function ye(){const t=D(),n=d(()=>t.playMode),e=d(()=>{const o=n.value;return o===P.SEQUENCE?"icon-sequence":o===P.RANDOM?"icon-random":"icon-loop"}),a=d(()=>{const o=n.value;return o===P.SEQUENCE?"play-cycle":o===P.RANDOM?"shuffle-one":"play-once"});return{modeIcon:e,currentMode:a,changeMode:()=>{const o=(n.value+1)%3;t.changeMode(o)}}}const ee=t=>(le("data-v-10425e4a"),t=t(),ie(),t),xe={class:"mt-8 sm:mt-28"},Ce={class:"player-title"},we=Z(" \u6211\u7684\u79C1\u4EBA\u97F3\u4E50\u574A > "),be={class:"flex items-center mt-6 flex-col-reverse sm:flex-row"},Te={class:"flex-1 w-full"},Me={class:"flex items-center h-9 mt-6 justify-center sm:mt-0 sm:justify-start"},We={class:"text-xl text-gray-800 text"},Ee={class:"text-sm text-gray-600 ml-1"},Pe=ee(()=>s("i",{class:"mx-1.5.5.5.5.5"},"-",-1)),Se={class:"flex items-center mt-8"},ke={class:"music-time mr-1.5"},Be={class:"music-time ml-1.5"},Re={class:"flex justify-between mt-10"},Ne={class:"inline-flex items-center"},Ie=ee(()=>s("i",{class:"icon icon-volume"},null,-1)),Oe={class:"w-16 ml-1.5"},Ae={class:"w-[180px] h-[180px] sm:ml-5"},Ve=["src","alt"],De=K({name:"Player",emits:["player:prev","player:next","player:timechange","player:volumechange"],setup(t,{emit:n}){const e=D(),a=d(()=>e.playing),r=d(()=>e.currentSong),o=d(()=>e.currentTime),p=d(()=>e.volume),{modeIcon:y,changeMode:g}=ye(),{cdRef:_,cdCoverRef:C,cdClass:M}=me(),W=d(()=>a.value?"icon-pause":"icon-play"),w=d(()=>{var h,E;const u=(E=(h=r.value)==null?void 0:h.duration)!=null?E:0;return o.value/u}),k=()=>{e.setPlaying(!a.value)},i=()=>n("player:prev"),l=()=>n("player:next"),v=u=>{e.setProgressChanging(!0),e.setCurrentTime(r.value.duration*u)},m=u=>{e.setProgressChanging(!1);const h=r.value.duration*u;e.setCurrentTime(h),n("player:timechange",h),a.value||e.setPlaying(!0)},f=u=>{e.setVolume(u),n("player:volumechange",u)};return(u,h)=>{var L,$,X,j,U;const E=ue("router-link");return Y(),J("div",xe,[s("h1",Ce,[R(E,{to:"/musics"},{default:re(()=>[we]),_:1})]),s("div",be,[s("div",Te,[s("div",Me,[s("span",We,S((L=c(r))==null?void 0:L.title),1),s("span",Ee,[Pe,Z(" "+S(($=c(r))==null?void 0:$.artist),1)])]),s("div",Se,[s("span",ke,S(c(F)(c(o))),1),R(H,{class:"flex-1",progress:c(w),onProgressChanging:v,onProgressChanged:m},null,8,["progress"]),s("span",Be,S(c(F)((X=c(r))==null?void 0:X.duration)),1)]),s("div",Re,[s("i",{class:N(["icon cursor-pointer",c(y)]),onClick:h[0]||(h[0]=(...te)=>c(g)&&c(g)(...te))},null,2),s("span",null,[s("i",{class:"icon icon-prev cursor-pointer",onClick:i}),s("i",{class:N(["icon cursor-pointer ml-5",c(W)]),onClick:k},null,2),s("i",{class:"icon icon-next cursor-pointer ml-5",onClick:l})]),s("div",Ne,[Ie,s("div",Oe,[R(H,{progress:c(p),onProgressChanging:f,onProgressChanged:f},null,8,["progress"])])])])]),s("div",Ae,[ae(s("div",{ref_key:"cdRef",ref:_},[s("img",{ref_key:"cdCoverRef",ref:C,class:N(["w-full h-full rounded-full",c(M)]),src:(j=c(r))==null?void 0:j.cover,alt:(U=c(r))==null?void 0:U.title},null,10,Ve)],512),[[ce,c(r)]])])])])}}});var $e=Q(De,[["__scopeId","data-v-10425e4a"]]);export{$e as default};
