import{g as oe,o as ne,w as V,u as l,_ as Q,d as K,r as C,c as d,a as se,b as Y,e as J,f as o,n as B,h as b,i as D,P as E,j as R,k as re,t as P,l as Z,m as z,p as N,q as ae,v as le,s as ce,x as ie,y as ue}from"./index.e2d2bd8e.js";function de(t){return oe()?(ne(t),!0):!1}var F;const T=typeof window!="undefined",pe=t=>typeof t=="string",I=()=>{};T&&((F=window==null?void 0:window.navigator)==null?void 0:F.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function ge(t){var s;const e=l(t);return(s=e==null?void 0:e.$el)!=null?s:e}const he=T?window:void 0;T&&window.document;T&&window.navigator;T&&window.location;function q(...t){let s,e,a,r;if(pe(t[0])?([e,a,r]=t,s=he):[s,e,a,r]=t,!s)return I;let n=I;const p=V(()=>ge(s),g=>{n(),g&&(g.addEventListener(e,a,r),n=()=>{g.removeEventListener(e,a,r),n=I})},{immediate:!0,flush:"post"}),y=()=>{p(),n()};return de(y),y}const O=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},A="__vueuse_ssr_handlers__";O[A]=O[A]||{};O[A];var G;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(G||(G={}));const fe={class:"bar-inner"},ve=["onMousedown","onMousemove","onMouseup","onTouchstart","onTouchmove","onTouchend"],me=K({__name:"ProgressBar",props:{progress:null,hasBtn:{type:Boolean,default:!0},barColor:{default:""}},emits:["progress-changing","progress-changed"],setup(t,{emit:s}){const e=t,a=16,r=C(0),n=C(null),p=C(null),y=d(()=>({width:`${r.value}px`,backgroundColor:e.barColor})),g=d(()=>({transform:`translate3d(${r.value}px,0,0)`}));V(()=>e.progress,i=>{var f;const c=((f=n.value)==null?void 0:f.clientWidth)-(e.hasBtn?a:0);r.value=c*i}),se(()=>{var c;const i=((c=n.value)==null?void 0:c.clientWidth)-(e.hasBtn?a:0);r.value=i*e.progress});const m={x1:0,beginWidth:0};let x=!1;const k=i=>{var c;x=!0,m.x1=i instanceof TouchEvent?i.touches[0].pageX:i.pageX,m.beginWidth=(c=p.value)==null?void 0:c.clientWidth},M=i=>{var u;if(!x)return;const c=(i instanceof TouchEvent?i.touches[0].pageX:i.pageX)-m.x1,f=m.beginWidth+c,_=((u=n.value)==null?void 0:u.clientWidth)-(e.hasBtn?a:0),v=Math.min(1,Math.max(f/_,0));r.value=_*v,s("progress-changing",v)},w=i=>{var _,v;if(!x)return;x=!1;const c=((_=n.value)==null?void 0:_.clientWidth)-(e.hasBtn?a:0),f=((v=p.value)==null?void 0:v.clientWidth)/c;s("progress-changed",f)},S=i=>{var u,h;const c=(u=n.value)==null?void 0:u.getBoundingClientRect(),f=i.pageX-c.left,_=((h=n.value)==null?void 0:h.clientWidth)-(e.hasBtn?a:0),v=Math.min(1,Math.max(f/_,0));s("progress-changed",v)};return q(document,"mouseup",w),q(document,"touchend",w),(i,c)=>(Y(),J("div",{ref_key:"barRef",ref:n,class:"progress-bar",onClick:S},[o("div",fe,[o("div",{ref_key:"progressRef",ref:p,class:"progress",style:B(l(y))},null,4),o("div",{class:"progress-btn-wrapper",style:B(l(g)),onMousedown:b(k,["prevent"]),onMousemove:b(M,["prevent"]),onMouseup:b(w,["prevent"]),onTouchstart:b(k,["prevent"]),onTouchmove:b(M,["prevent"]),onTouchend:b(w,["prevent"]),onClick:c[0]||(c[0]=b(()=>{},["stop"]))},[o("div",{class:"progress-btn",style:B({backgroundColor:e.barColor})},null,4)],44,ve)])],512))}});var H=Q(me,[["__scopeId","data-v-6b780afa"]]);function _e(){const t=C(null),s=C(null),e=D(),a=d(()=>e.playing),r=d(()=>a.value?"playing":"");V(a,p=>{p||n(t.value,s.value)});function n(p,y){const g=getComputedStyle(p).transform,m=getComputedStyle(y).transform;p.style.transform=g==="none"?m:m.concat(g)}return{cdRef:t,cdCoverRef:s,cdClass:r}}function ye(){const t=D(),s=d(()=>t.playMode),e=d(()=>{const n=s.value;return n===E.SEQUENCE?"icon-sequence":n===E.RANDOM?"icon-random":"icon-loop"}),a=d(()=>{const n=s.value;return n===E.SEQUENCE?"play-cycle":n===E.RANDOM?"shuffle-one":"play-once"});return{modeIcon:e,currentMode:a,changeMode:()=>{const n=(s.value+1)%3;t.changeMode(n)}}}const ee=t=>(ce("data-v-10425e4a"),t=t(),ie(),t),be={class:"mt-8 sm:mt-28"},xe={class:"player-title"},we=Z(" \u6211\u7684\u79C1\u4EBA\u97F3\u4E50\u574A > "),Ce={class:"flex items-center mt-6 flex-col-reverse sm:flex-row"},Te={class:"flex-1 w-full"},ke={class:"flex items-center h-9 mt-6 justify-center sm:mt-0 sm:justify-start"},Me={class:"text-xl text-gray-800 text"},We={class:"text-sm text-gray-600 ml-1"},Ee=ee(()=>o("i",{class:"mx-1.5.5.5.5.5"},"-",-1)),Pe={class:"flex items-center mt-8"},Se={class:"music-time mr-1.5"},Be={class:"music-time ml-1.5"},Re={class:"flex justify-between mt-10"},Ne={class:"inline-flex items-center"},Ie=ee(()=>o("i",{class:"icon icon-volume"},null,-1)),Oe={class:"w-16 ml-1.5"},Ae={class:"w-[180px] h-[180px] sm:ml-5"},Ve=["src","alt"],De=K({__name:"Player",emits:["player:prev","player:next","player:timechange","player:volumechange"],setup(t,{emit:s}){const e=D(),a=d(()=>e.playing),r=d(()=>e.currentSong),n=d(()=>e.currentTime),p=d(()=>e.volume),{modeIcon:y,changeMode:g}=ye(),{cdRef:m,cdCoverRef:x,cdClass:k}=_e(),M=d(()=>a.value?"icon-pause":"icon-play"),w=d(()=>{var h,W;const u=(W=(h=r.value)==null?void 0:h.duration)!=null?W:0;return n.value/u}),S=()=>{e.setPlaying(!a.value)},i=()=>s("player:prev"),c=()=>s("player:next"),f=u=>{e.setProgressChanging(!0),e.setCurrentTime(r.value.duration*u)},_=u=>{e.setProgressChanging(!1);const h=r.value.duration*u;e.setCurrentTime(h),s("player:timechange",h),a.value||e.setPlaying(!0)},v=u=>{e.setVolume(u),s("player:volumechange",u)};return(u,h)=>{var L,$,X,j,U;const W=ue("router-link");return Y(),J("div",be,[o("h1",xe,[R(W,{to:"/musics"},{default:re(()=>[we]),_:1})]),o("div",Ce,[o("div",Te,[o("div",ke,[o("span",Me,P((L=l(r))==null?void 0:L.title),1),o("span",We,[Ee,Z(" "+P(($=l(r))==null?void 0:$.artist),1)])]),o("div",Pe,[o("span",Se,P(l(z)(l(n))),1),R(H,{class:"flex-1",progress:l(w),onProgressChanging:f,onProgressChanged:_},null,8,["progress"]),o("span",Be,P(l(z)((X=l(r))==null?void 0:X.duration)),1)]),o("div",Re,[o("i",{class:N(["icon cursor-pointer",l(y)]),onClick:h[0]||(h[0]=(...te)=>l(g)&&l(g)(...te))},null,2),o("span",null,[o("i",{class:"icon icon-prev cursor-pointer",onClick:i}),o("i",{class:N(["icon cursor-pointer ml-5",l(M)]),onClick:S},null,2),o("i",{class:"icon icon-next cursor-pointer ml-5",onClick:c})]),o("div",Ne,[Ie,o("div",Oe,[R(H,{progress:l(p),onProgressChanging:v,onProgressChanged:v},null,8,["progress"])])])])]),o("div",Ae,[ae(o("div",{ref_key:"cdRef",ref:m},[o("img",{ref_key:"cdCoverRef",ref:x,class:N(["w-full h-full rounded-full",l(k)]),src:(j=l(r))==null?void 0:j.cover,alt:(U=l(r))==null?void 0:U.title},null,10,Ve)],512),[[le,l(r)]])])])])}}});var $e=Q(De,[["__scopeId","data-v-10425e4a"]]);export{$e as default};
